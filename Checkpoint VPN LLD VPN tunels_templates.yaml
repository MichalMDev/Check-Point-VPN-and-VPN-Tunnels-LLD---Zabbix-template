zabbix_export:
  version: '6.0'
  date: '2023-03-23T10:15:46Z'
  groups:
    -
      uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
  templates:
    -
      uuid: d94267f30da64ec8accef01306fb5cbe
      template: 'Checkpoint VPN LLD VPN tunels'
      name: 'Checkpoint VPN LLD VPN tunels'
      description: |
        Check /usr/lib/zabbix/externalscripts and edit cp_vpn_list.json
        
        From: template_checkpoint_vpn-1 
        ## Overview
        
        Use this template to monitor Checkpoint firewalls VPN activity.
        
        
         
        ****
        
        
         
        
        
        The following value map must be created for the Checkpoint templates collection :
        
        
         
        
        
        "Checkpoint standard status"
        
        
         
        
        
        0 ⇒ OK
        
        
         
        
        
        1 ⇒ Warning
        
        
         
        
        
        2 ⇒ Error
        
        
         
        
        
        The advsnmp.discovery external script (https://github.com/simonkowallik/Zabbix-Addons/tree/master/advsnmp.discovery) is also needed by most templates.
        
        
        Last, the SNMP items reference the CHECKPOINT-MIB (chkpnt.mib, see https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit\_doGoviewsolutiondetails=&solutionid=sk90470#Check Point SNMP MIB files for all products) so it must be properly installed on your Zabbix server.
      groups:
        -
          name: Templates
      items:
        -
          uuid: ec807fe2ddb7411ca6279fc65948f37f
          name: 'Current Inbound IPSec SAs'
          type: SNMP_AGENT
          snmp_oid: 'CHECKPOINT-MIB::cpvCurrEspSAsIn.0'
          key: cpvCurrEspSAsIn
          delay: '120'
          tags:
            -
              tag: Application
              value: 'Checkpoint VPN-1'
        -
          uuid: 43be1abc34e3499d8e73137d56775823
          name: 'Current Outbound IPSec SAs'
          type: SNMP_AGENT
          snmp_oid: 'CHECKPOINT-MIB::cpvCurrEspSAsOut.0'
          key: cpvCurrEspSAsOut
          delay: '120'
          tags:
            -
              tag: Application
              value: 'Checkpoint VPN-1'
        -
          uuid: b3b13140eb2f4ddabd1e93834ddbabda
          name: 'VPN Decrypted Packets/s'
          type: SNMP_AGENT
          snmp_oid: 'CHECKPOINT-MIB::cpvDecPackets.0'
          key: cpvDecPackets
          delay: '120'
          value_type: FLOAT
          units: pps
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'Checkpoint VPN-1'
        -
          uuid: 17fbf2f2cdad48d0bbcbdcd329c45b14
          name: 'VPN Encrypted Packets/s'
          type: SNMP_AGENT
          snmp_oid: 'CHECKPOINT-MIB::cpvEncPackets.0'
          key: cpvEncPackets
          delay: '120'
          value_type: FLOAT
          units: pps
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'Checkpoint VPN-1'
        -
          uuid: b3d05d43942a48c589834019781fa52d
          name: 'Current IKE SAs'
          type: SNMP_AGENT
          snmp_oid: 'CHECKPOINT-MIB::cpvIKECurrSAs.0'
          key: cpvIKECurrSAs
          delay: '120'
          tags:
            -
              tag: Application
              value: 'Checkpoint VPN-1'
      discovery_rules:
        -
          uuid: be61e66c3b774520913e3f9a278e379b
          name: 'VPN tunnels discovery'
          type: EXTERNAL
          key: 'cp_vpn_list.sh["cp_vpn_list.json"]'
          delay: 30m
          item_prototypes:
            -
              uuid: 2008b42ca0264a648550fac9c10a27bf
              name: 'VPN Tunnel Status for {#NAME} - {#IP}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2620.500.9002.1.3.{#IP}.0'
              key: 'vpnTunnelStatus[{#NAME}]'
              delay: 3m
              history: 60d
              valuemap:
                name: 'SG-VPN Status'
              trigger_prototypes:
                -
                  uuid: 6f15ee2dd41b49b29d9191da179c8882
                  expression: 'find(/Checkpoint VPN LLD VPN tunels/vpnTunnelStatus[{#NAME}])=131'
                  name: 'VPN Tunnel Status [{#NAME}] - down'
                  priority: HIGH
                -
                  uuid: 6c1bbe7906344db683cad94c66cf0009
                  expression: 'find(/Checkpoint VPN LLD VPN tunels/vpnTunnelStatus[{#NAME}])>130'
                  name: 'VPN Tunnel Status [{#NAME}] - init'
                  priority: INFO
          graph_prototypes:
            -
              uuid: 84ae008c60c742c3a26b8141101244e7
              name: 'VPN Tunnel Status for {#NAME}'
              graph_items:
                -
                  color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Checkpoint VPN LLD VPN tunels'
                    key: 'vpnTunnelStatus[{#NAME}]'
          lld_macro_paths:
            -
              lld_macro: '{#IP}'
              path: $.ip
            -
              lld_macro: '{#NAME}'
              path: $.name
      valuemaps:
        -
          uuid: 3fe795778148453f8be5321f9400ba8f
          name: 'Checkpoint standard status'
          mappings:
            -
              value: '0'
              newvalue: OK
            -
              value: '1'
              newvalue: Warning
            -
              value: '2'
              newvalue: Error
        -
          uuid: 8466e1de9e8a4b9b8527f99050893267
          name: 'SG-VPN Status'
          mappings:
            -
              value: '3'
              newvalue: active
            -
              value: '4'
              newvalue: destroy
            -
              value: '129'
              newvalue: idle
            -
              value: '130'
              newvalue: phase1
            -
              value: '131'
              newvalue: down
            -
              value: '132'
              newvalue: init
  graphs:
    -
      uuid: 12c7b24f968d4b31a22e7ac1f5d19c5e
      name: 'VPN-1 Activity'
      ymin_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: '666666'
          item:
            host: 'Checkpoint VPN LLD VPN tunels'
            key: cpvIKECurrSAs
        -
          sortorder: '1'
          drawtype: BOLD_LINE
          color: 00C800
          item:
            host: 'Checkpoint VPN LLD VPN tunels'
            key: cpvCurrEspSAsIn
        -
          sortorder: '2'
          drawtype: BOLD_LINE
          color: FF3333
          item:
            host: 'Checkpoint VPN LLD VPN tunels'
            key: cpvCurrEspSAsOut
    -
      uuid: 8e65a74736d04097b4cb0d17b1ef5883
      name: 'VPN-1 Traffic'
      ymin_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 00BB00
          yaxisside: RIGHT
          item:
            host: 'Checkpoint VPN LLD VPN tunels'
            key: cpvDecPackets
        -
          sortorder: '1'
          drawtype: BOLD_LINE
          color: FF3333
          yaxisside: RIGHT
          item:
            host: 'Checkpoint VPN LLD VPN tunels'
            key: cpvEncPackets
